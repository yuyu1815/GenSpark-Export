# GenSpark Export Chrome拡張機能

## バージョン情報

**バージョン 1.1.0** - 最新版

### リリースノート

新しいChrome拡張機能：GenSpark ExportはGenSpark AIからのデータ抽出を簡素化します

GenSpark Exportの発表に喜びを感じています。これは、GenSpark
AIアプリケーションでの生産性を向上させるために設計された新しいChrome拡張機能です。この強力なツールにより、ユーザーはGenSparkページから表データを簡単にユーザーフレンドリーな形式にエクスポートできます。

**主な機能：**

- **ワンクリックエクスポート**：任意のGenSparkページ（URLに「https://www.genspark.ai/agents?」を含む）からデータテーブルを簡単にエクスポート。
- **CSV/Excelエクスポート**：すべてのテーブルデータを単一のCSVファイルとしてダウンロード。Microsoft
  Excelとの互換性に最適化されています。複数のタブがある場合、そのデータは明確な区切りで1つのCSVに統合されます。
- **タブ付きExcelエクスポート**
  ：データを適切なExcelファイル（.xlsx）としてエクスポート。GenSparkの各タブはワークブック内の別々のシートとして表示されます。この機能は、堅牢なExcelファイル生成のためにxlsx-populateライブラリを使用しています。
- **Markdownエクスポート**
  ：テーブルデータをMarkdown形式でエクスポート。GitHubやその他のMarkdownをサポートするプラットフォームでの共有や文書化に最適です。複数のタブがある場合、各タブは見出しで区切られます。
- **UTF-8エンコーディング**：UTF-8 BOM（バイトオーダーマーク）を含めることで、Excel内での適切な文字表示を保証します。
- **シームレスな統合**：拡張機能は「CSVにエクスポート」、「タブ付きExcelにエクスポート」、「Markdownにエクスポート」ボタンをGenSparkテーブルビューに直接自動的に追加します。

GenSpark Exportはシンプルで直感的に設計されており、データワークフローを効率化し、貴重な時間を節約します。

**はじめに：**

今すぐGenSpark Export Chrome拡張機能をインストールして、GenSparkデータをより効率的に操作する方法を体験してください！

## 概要

このChrome拡張機能は、GenSpark AIアプリケーションに便利なデータエクスポートとコピー機能を追加します。ユーザーはGenSparkプラットフォームから表データを
**CSV**または**Excel (.xlsx)**形式でワンクリックでエクスポートでき、また**選択したセルの内容を直接コピー**
するための簡単な方法も提供します。

## 機能

- **自動検出**：テーブルを含むGenSparkページで自動的に有効化（URLが`https://www.genspark.ai/agents?*`に一致する場合）
- **3つのエクスポートオプション**：テーブルビューに3つの異なるエクスポートボタンを追加：
    - **「CSVにエクスポート」**
      ：すべてのタブのデータを単一のCSVファイルにエクスポート。シンプルなデータリストや様々なスプレッドシートソフトウェアとの互換性に最適。Excel内での適切な文字エンコーディングのためのUTF-8
      BOMを含む。
    - **「タブ付きExcelにエクスポート」**
      ：すべてのタブのデータを単一の複数シートExcel（.xlsx）ファイルにエクスポート。GenSparkの各タブはExcelファイル内の別々のシートになります。信頼性の高いExcel生成のために
      `xlsx-populate`ライブラリを使用。タブ区切りが重要な複雑なデータ分析に最適。
  - **「Markdownにエクスポート」**
    ：テーブルデータをMarkdown形式でエクスポート。標準的なMarkdownテーブル構文を使用し、GitHubやその他のMarkdownをサポートするプラットフォームでの共有や文書化に最適。複数のタブがある場合、各タブは見出しで区切られます。
- **複数タブのサポート**：GenSparkテーブルインターフェース内のすべての利用可能なタブを自動的に検出し、エクスポート中に各タブからデータを収集
- **Excel互換性**：CSVエクスポートにはBOMと適切な引用符/エスケープが含まれ、Microsoft
  Excelやその他のスプレッドシートアプリケーションとの互換性を確保。XLSXエクスポートはネイティブExcel形式を提供
- **セルコピー機能**：テーブルセルをクリックすると表示されるコンテキストメニューに「セルをコピー」ボタンを追加
- **カスタマイズ可能なセル区切り文字**
  ：複数のセルをコピーする際に使用する区切り文字（スペース、パイプ、カンマ、タブなど）をカスタマイズするための設定ポップアップを提供（拡張機能アイコンからアクセス可能）。設定は次回以降のセッションでも保存されます。
- **ユーザーフレンドリーなインターフェース**：GenSpark UIに直接統合されたシンプルなボタンと明確な機能

## 要件

- Google Chromeブラウザ
- データテーブルを含むページにアクセスできるGenSparkアカウント
- **開発/ビルド用**：Node.jsとnpm（またはyarn）

## インストール

ソースコードから拡張機能をインストールするには：

1. このリポジトリをローカルマシンにクローンします。
   ```bash
   git clone [https://github.com/YOUR_USERNAME/YOUR_REPOSITORY_NAME.git](https://github.com/YOUR_USERNAME/YOUR_REPOSITORY_NAME.git)
   cd YOUR_REPOSITORY_NAME
   ```
2. npmを使用して必要な依存関係をインストールします。
   ```bash
   npm install
   ```
3. 拡張機能ファイルをビルドします。
   ```bash
   npm run build
   ```
   （または、Windowsでは`build.bat`を実行できます）
   これにより、ビルドファイルを含む`dist`ディレクトリが作成されます。
4. Chromeを開き、`chrome://extensions/`に移動します。
5. 右上隅のトグルスイッチを使用して「デベロッパーモード」を有効にします。
6. 「パッケージ化されていない拡張機能を読み込む」ボタンをクリックし、ステップ3で作成された`dist`ディレクトリを選択します。
7. これで拡張機能がインストールされ、GenSparkページで使用できるようになりました。

## 使用方法

1. データテーブルを含むGenSparkページに移動します（URLが`https://www.genspark.ai/agents?*`に一致する必要があります）。
2. 拡張機能は自動的にテーブルビューに3つのエクスポートボタンを追加します：
    - **「CSVにエクスポート」**
    - **「タブ付きExcelにエクスポート」**
   - **「Markdownにエクスポート」**
3. ニーズに最適なエクスポートオプションを選択します：
    - **「CSVにエクスポート」**：このボタンをクリックすると、すべてのテーブルデータを単一のCSVファイルとしてダウンロードします。
        - 複数のタブがある場合、すべてのタブのデータは明確なタブ区切りで1つのCSVファイルに結合されます。
        - これはシンプルなデータリストや、様々なスプレッドシートソフトウェアとの互換性に最適です。
    - **「タブ付きExcelにエクスポート」**：このボタンをクリックすると、データを適切なExcelファイル（.xlsx）としてダウンロードします。
        - GenSparkの各タブのデータはExcelファイル内の別々のシートとしてエクスポートされます。
        - シート名はGenSparkのタブ名に対応します。
        - この機能は`xlsx-populate`ライブラリを使用して堅牢なExcelファイルを生成します。
        - これはタブ区切りが重要な複雑なデータ分析に最適です。
   - **「Markdownにエクスポート」**：このボタンをクリックすると、テーブルデータをMarkdown形式でダウンロードします。
       - 標準的なMarkdownテーブル構文（`|`と`-`を使用）でフォーマットされます。
       - 複数のタブがある場合、各タブは見出し（`## タブ名`）で区切られます。
       - GitHubやその他のMarkdownをサポートするプラットフォームでの共有や文書化に最適です。
       - これはドキュメントやREADMEファイルにテーブルを含める場合に便利です。
4. エクスポートプロセス中（すべてのオプションで）、拡張機能は以下を行います：
    - 利用可能なすべてのタブを自動的に検出します。
    - 一時的に各タブに切り替えてデータを抽出します。
    - データ収集が完了した後、元のアクティブタブに戻ります。
5. セルの内容をコピーするには：
    - テーブル内の単一のセルをクリックするか、クリックしてドラッグして複数のセルを選択します。
    - 選択の近くに小さなポップアップメニューが表示されます。このメニューの「セルをコピー」ボタンをクリックします。
    - 選択したセルの内容がクリップボードにコピーされます。複数のセルを選択した場合、その内容は設定された区切り文字で結合されます。
6. セル区切り文字をカスタマイズするには：
    - Chromeツールバーの「GenSpark Export」拡張機能アイコンをクリックします。
    - 小さなポップアップウィンドウが表示されます。入力フィールドに希望の区切り文字（例：`,`、`|`、`-`
      、または「tab」とタイプしてタブ文字）を入力します。
    - 「保存」ボタンをクリックして変更を適用します。
    - デフォルトのスペース区切りを使用するには、フィールドを空のままにします。
    - 設定は自動的に保存され、今後のすべてのセルコピー操作に使用されます。

## 開発

この拡張機能は以下を使用して構築されています：
- JavaScript
- Chrome Extension API
- ビルドプロセス用のNode.js
- バンドル用のwebpack
- Excelファイル生成用のxlsx-populate

## プロジェクト構造

- `src/`：ソースコード
    - `manifest.json`：拡張機能の設定
    - `content.js`：GenSparkページで実行されるコンテンツスクリプト
    - `background.js`：拡張機能のバックグラウンドスクリプト
    - `popup.html`：設定ポップアップのHTML
    - `popup.css`：設定ポップアップのスタイル
    - `popup.js`：設定ポップアップのJavaScript
    - `content.css`：コンテンツスクリプトのスタイル
    - `icons/`：拡張機能のアイコン
- `build.bat`：拡張機能をパッケージ化するビルドスクリプト
- `build.js`：Node.jsビルドスクリプト
- `webpack.config.js`：webpack設定
- `dist/`：ビルドされた拡張機能の出力ディレクトリ（ビルドスクリプトによって作成）

## ビルドプロセス

1. 依存関係をインストール：`npm install`
2. ビルドスクリプトを実行：`npm run build`
    - これにより、webpackがJavaScriptファイルを依存関係とともにバンドルします
    - その後、manifest.jsonとアイコンをdistディレクトリにコピーします
3. 拡張機能ファイルは`dist`ディレクトリにあります
4. インストールセクションで説明されているように、Chromeで拡張機能を読み込みます

## ライセンス

詳細はLICENSEファイルを参照してください。
